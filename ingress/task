Практическое задание
Создайте два deployment с именами dep-main , dep-canary. Добавьте к деплойментам label app=dep-main и app=dep-canary, соотвественно.
Создайте два сервиса clusterIP с именами svc-dep-main и svc-dep-canary. Настройте их на соотвествующие деплойменты (сделайте так, чтобы селектор был только по одному лейблу). Пусть первый сервис открывает порты 8080 и 8443, а второй — 9090 и 9443 (порты назначения в подах оставьте прежние).
При помощи curl проверьте работоспособность своих сервисов через порты 8080 и 9090.
Создайте два ингресса с именами ingr-main и ingr-canary и хостами main-x.x.x.x.nip.io и canary-x.x.x.x.io. x.x.x.x — это IP сервиса вашего ингресс-контроллера (каждый смотрит на соотвествующий сервис).
Проверьте работоспособность ingress при помощи curl.
Включите basic auth на Ingress ingr-main. Секрет должен называться basic-auth-secret.
На ingr-canary включите режим canary и поменяйте имя хоста на main-x.x.x.x.nip.io и выставите вес в 70.
Обратитесь несколько раз к url и проверьте работоспособность basic auth и canary.
На ingr-canary выставите вес в 100 и проверьте, что получилось. Не меняя значений, отправьте задание на проверку.